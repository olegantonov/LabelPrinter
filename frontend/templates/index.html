<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Etiquetas - Benu ERP</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Sistema de Impressao de Etiquetas</h1>
            <div class="header-info">
                <span id="system-version" class="version-badge">v3.0</span>
                <span id="benu-connection-status" class="status-badge disabled">Benu: Verificando...</span>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="impressao">Imprimir Etiqueta</button>
            <button class="tab-btn" data-tab="impressoras">Impressoras</button>
            <button class="tab-btn" data-tab="configuracoes">Configuracoes</button>
        </nav>

        <!-- Tab: Impressao -->
        <section id="tab-impressao" class="tab-content active">
            <!-- Busca Benu -->
            <div class="config-section">
                <h3>Buscar no Benu ERP</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tipo de Busca:</label>
                        <select id="benu-tipo-busca" class="form-control">
                            <option value="os">Ordem de Servico</option>
                            <option value="orcamentos">Orcamentos</option>
                            <option value="crm">CRM (Clientes)</option>
                        </select>
                    </div>
                    <div class="form-group flex-2">
                        <label>Termo de Busca:</label>
                        <input type="text" id="benu-termo" class="form-control" placeholder="Nome, codigo, documento...">
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button type="button" id="btn-buscar-benu" class="btn btn-primary">Buscar</button>
                    </div>
                </div>
                <div id="benu-resultados" style="display: none;">
                    <h4>Resultados:</h4>
                    <div id="benu-lista-resultados" class="benu-resultados-lista"></div>
                </div>
            </div>

            <!-- Formulario de Edicao -->
            <div class="config-section" id="card-edicao" style="display: none;">
                <h3>Dados para Etiqueta <small style="font-weight: normal; color: #666;">(edite se necessario)</small></h3>
                <form id="form-etiqueta">
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label>Nome/Empresa:</label>
                            <input type="text" id="etiq-nome" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Destinatario (A/C):</label>
                            <input type="text" id="etiq-destinatario" class="form-control" placeholder="Opcional">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label>Logradouro:</label>
                            <input type="text" id="etiq-logradouro" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Numero:</label>
                            <input type="text" id="etiq-numero" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Complemento:</label>
                            <input type="text" id="etiq-complemento" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Bairro:</label>
                            <input type="text" id="etiq-bairro" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>CEP:</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="text" id="etiq-cep" class="form-control" placeholder="00000-000" required>
                                <button type="button" id="btn-buscar-cep" class="btn btn-sm btn-secondary">Buscar</button>
                            </div>
                        </div>
                        <div class="form-group flex-2">
                            <label>Cidade:</label>
                            <input type="text" id="etiq-cidade" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Estado:</label>
                            <select id="etiq-estado" class="form-control" required>
                                <option value="">UF</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                                <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                                <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                                <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                                <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                                <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                                <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                                <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                                <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                    </div>

                    <hr style="margin: 20px 0;">

                    <div class="form-row">
                        <div class="form-group">
                            <label>Tipo de Etiqueta:</label>
                            <select id="etiq-tipo" class="form-control" required>
                                <option value="thermal_60x30">Termica 60x30mm</option>
                                <option value="thermal_100x80">Termica 100x80mm</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quantidade:</label>
                            <input type="number" id="etiq-quantidade" class="form-control" value="1" min="1" max="100">
                        </div>
                        <div class="form-group">
                            <label>Impressora:</label>
                            <select id="etiq-impressora" class="form-control">
                                <option value="">-- Usar padrao --</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="etiq-codigo-barras" checked>
                                Incluir codigo de barras (CEPNet)
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="etiq-remetente">
                                Incluir remetente
                            </label>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" id="btn-limpar-form" class="btn btn-secondary">Limpar</button>
                        <button type="button" id="btn-preview" class="btn btn-secondary">Visualizar</button>
                        <button type="button" id="btn-download" class="btn btn-info">Download PDF</button>
                        <button type="submit" id="btn-imprimir" class="btn btn-primary">Imprimir</button>
                    </div>
                </form>
            </div>

            <!-- Preview -->
            <div id="preview-container" class="config-section" style="display: none;">
                <h3>Preview da Etiqueta</h3>
                <iframe id="preview-iframe" style="width: 100%; height: 300px; border: 1px solid #ccc;"></iframe>
            </div>
        </section>

        <!-- Tab: Impressoras -->
        <section id="tab-impressoras" class="tab-content">
            <div class="section-header">
                <h2>Gerenciar Impressoras</h2>
                <div>
                    <button id="btn-detectar-impressoras" class="btn btn-secondary">Detectar do Sistema</button>
                    <button id="btn-nova-impressora" class="btn btn-primary">Nova Impressora</button>
                </div>
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Nome Sistema</th>
                        <th>Tipo</th>
                        <th>Status</th>
                        <th>Acoes</th>
                    </tr>
                </thead>
                <tbody id="lista-impressoras">
                    <tr><td colspan="5" class="empty-state">Carregando...</td></tr>
                </tbody>
            </table>

            <div class="config-section" style="margin-top: 20px;">
                <h3>Impressora Padrao por Tipo de Etiqueta</h3>
                <div id="config-etiquetas"></div>
            </div>
        </section>

        <!-- Tab: Configuracoes -->
        <section id="tab-configuracoes" class="tab-content">
            <h2>Configuracoes do Sistema</h2>

            <!-- Integracao Benu ERP -->
            <div class="config-section">
                <h3>Integracao Benu ERP</h3>
                <div class="form-row">
                    <div class="form-group flex-2">
                        <label>Token de Autenticacao (Bearer):</label>
                        <input type="password" id="benu-token" class="form-control" placeholder="Cole seu token aqui">
                    </div>
                    <div class="form-group" style="display: flex; align-items: flex-end; gap: 5px;">
                        <button type="button" id="btn-salvar-benu-token" class="btn btn-primary">Salvar</button>
                        <button type="button" id="btn-testar-benu" class="btn btn-secondary">Testar</button>
                    </div>
                </div>
                <small>Base URL: https://www.benuerp.com.br | Timeout: 30s</small>
            </div>

            <!-- Dados do Remetente -->
            <div class="config-section">
                <h3>Dados do Remetente</h3>
                <form id="form-remetente">
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label>Nome/Empresa:</label>
                            <input type="text" id="rem-nome" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label>Logradouro:</label>
                            <input type="text" id="rem-logradouro" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Numero:</label>
                            <input type="text" id="rem-numero" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Complemento:</label>
                            <input type="text" id="rem-complemento" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Bairro:</label>
                            <input type="text" id="rem-bairro" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>CEP:</label>
                            <input type="text" id="rem-cep" class="form-control" placeholder="00000-000" required>
                        </div>
                        <div class="form-group flex-2">
                            <label>Cidade:</label>
                            <input type="text" id="rem-cidade" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Estado:</label>
                            <select id="rem-estado" class="form-control" required>
                                <option value="">UF</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                                <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                                <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                                <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                                <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                                <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                                <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                                <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                                <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Salvar Remetente</button>
                </form>
            </div>

            <!-- Configuracoes de Etiqueta -->
            <div class="config-section">
                <h3>Configuracoes de Etiqueta</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Resolucao (DPI):</label>
                        <input type="number" id="etiqueta-dpi" class="form-control" value="300" min="150" max="600">
                    </div>
                    <div class="form-group">
                        <label>Tamanho Fonte Minimo:</label>
                        <input type="number" id="etiqueta-fonte" class="form-control" value="10" min="8" max="14">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="etiqueta-cepnet" checked>
                            Incluir CEPNet (codigo de barras)
                        </label>
                    </div>
                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="etiqueta-datamatrix">
                            Incluir Data Matrix
                        </label>
                    </div>
                </div>
                <button type="button" id="btn-salvar-etiqueta-config" class="btn btn-primary">Salvar Configuracoes</button>
            </div>

            <!-- Sistema de Atualizacao -->
            <div class="config-section">
                <h3>Atualizacoes do Sistema</h3>
                <p>
                    <strong>Versao Atual:</strong> <span id="versao-atual">Carregando...</span><br>
                    <strong>Ultima Verificacao:</strong> <span id="ultima-verificacao">-</span>
                </p>
                <div class="button-group">
                    <button type="button" id="btn-verificar-atualizacao" class="btn btn-secondary">Verificar Atualizacoes</button>
                    <button type="button" id="btn-aplicar-atualizacao" class="btn btn-primary" disabled>Aplicar Atualizacao</button>
                </div>
                <div id="atualizacao-status" class="status-message" style="margin-top: 10px;"></div>
            </div>
        </section>
    </div>

    <!-- Modal: Impressora -->
    <div id="modal-impressora" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h3 id="modal-impressora-titulo">Nova Impressora</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="form-impressora">
                <input type="hidden" id="impressora-id">
                <div class="form-group">
                    <label>Nome:</label>
                    <input type="text" id="impressora-nome" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Nome no Sistema (CUPS):</label>
                    <input type="text" id="impressora-nome-sistema" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Tipo:</label>
                    <select id="impressora-tipo" class="form-control" required>
                        <option value="termica">Termica</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Modelo:</label>
                    <input type="text" id="impressora-modelo" class="form-control">
                </div>
                <div class="form-group">
                    <label>Localizacao:</label>
                    <input type="text" id="impressora-localizacao" class="form-control">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Impressoras do Sistema -->
    <div id="modal-impressoras-sistema" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Impressoras Detectadas no Sistema</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div id="lista-impressoras-sistema"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-cancel">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
